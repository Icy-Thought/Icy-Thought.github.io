<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A short guide about merging your two mistakes into one larger mistake."><title>Merge 2 Partitions Into 1</title><link rel=canonical href=https://icy-thought.github.io/p/unify-partitions/><link rel=stylesheet href=/scss/style.min.18145888f21de6cb02d8cb0891be8240096206785da14eda35f6c23c239b966a.css><meta property="og:title" content="Merge 2 Partitions Into 1"><meta property="og:description" content="A short guide about merging your two mistakes into one larger mistake."><meta property="og:url" content="https://icy-thought.github.io/p/unify-partitions/"><meta property="og:site_name" content="Cursed Notebook"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2021-03-16T21:21:12+00:00"><meta property="article:modified_time" content="2021-03-16T21:21:12+00:00"><meta name=twitter:title content="Merge 2 Partitions Into 1"><meta name=twitter:description content="A short guide about merging your two mistakes into one larger mistake."></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu286d90eaa6fe59384acf196e21126a89_55296_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ðŸ¦Š</span></figure><div class=site-meta><h1 class=site-name><a href=/>Cursed Notebook</a></h1><h2 class=site-description>A public notebook for everyone to benefit from.</h2></div></header><ol class=social-menu><li><a href=https://github.com/Icy-Thought target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/Icy-Thought target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/p/unify-partitions/>Merge 2 Partitions Into 1</a></h2><h3 class=article-subtitle>A short guide about merging your two mistakes into one larger mistake.</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Mar 16, 2021</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><h1 id=first-and-foremost>First and Foremost&mldr;</h1><p>I am not responsible over whatever shit that might occur during your migration
process. What I am doing in this guide is documenting the process of the
migration for my two previous partitions into one unified partition for the
sake of seeking this guide when required.</p><h1 id=getting-started>Getting Started</h1><p>/Have you ever gotten into a situation where you have to clean your /root
partitions cache constantly because it keeps getting full? And by any chance,
did you create a separate /home and /root partition which you now regret doing?
If so then this guide is for you!/</p><blockquote><p><strong>Note</strong>
Before proceeding with anything you need to know this: <em>do not remove more
than the /home partition after backing it up in another partition and it&rsquo;s
also advised that you back up both the partitions in another partition than
/root!</em></p></blockquote><blockquote><p><strong>WARNING</strong>
Before we start off with the guide I need to clarify this that you should
apply the commands based on your partition scheme and that this guide is
written based on my partition scheme! So please, be cautious and follow this
guide with the help of an experienced person if you do not understand what
you should do!**</p></blockquote><h2 id=current-partition-scheme>Current Partition Scheme</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>arch@archlinux ~<span class=o>]</span>$ lsblk
</span></span><span class=line><span class=cl>NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
</span></span><span class=line><span class=cl>loop0    7:0    <span class=m>0</span>  87.9M  <span class=m>1</span> loop /var/lib/snapd/snap/core/5548
</span></span><span class=line><span class=cl>sda      8:0    <span class=m>0</span> 465.8G  <span class=m>0</span> disk
</span></span><span class=line><span class=cl>â”œâ”€sda1   8:1    <span class=m>0</span>   300M  <span class=m>0</span> part
</span></span><span class=line><span class=cl>â”œâ”€sda2   8:2    <span class=m>0</span>   100M  <span class=m>0</span> part
</span></span><span class=line><span class=cl>â”œâ”€sda3   8:3    <span class=m>0</span>   128M  <span class=m>0</span> part
</span></span><span class=line><span class=cl>â”œâ”€sda4   8:4    <span class=m>0</span> 232.7G  <span class=m>0</span> part
</span></span><span class=line><span class=cl>â”œâ”€sda5   8:5    <span class=m>0</span>   550M  <span class=m>0</span> part /boot
</span></span><span class=line><span class=cl>â”œâ”€sda6   8:6    <span class=m>0</span>    12G  <span class=m>0</span> part <span class=o>[</span>SWAP<span class=o>]</span>
</span></span><span class=line><span class=cl>â”œâ”€sda7   8:7    <span class=m>0</span>    20G  <span class=m>0</span> part /
</span></span><span class=line><span class=cl>â””â”€sda8   8:8    <span class=m>0</span>   200G  <span class=m>0</span> part /home
</span></span><span class=line><span class=cl>sr0     11:0    <span class=m>1</span>  1024M  <span class=m>0</span> rom
</span></span></code></pre></td></tr></table></div></div><h1 id=the-surgery>The surgery</h1><h2 id=important>IMPORTANT</h2><ul><li><p>Make sure to remove cached files which you won&rsquo;t be needing for this
procedure to reduce the amount of time required to backup your files!</p></li><li><p>Backup <code>/home</code>: will later be used to restore all the files after home
partition (<code>/dev/sdaX</code>) has been removed and turned into anllocated space.</p><ul><li><code>sudo tar czpvf /PATH/TO/BACKUP_PARTITION/home.tar.gz -C /home .</code></li></ul></li><li><p>Backup <code>/root</code>: if something wrong happens throughout the process, this
backup would be used to ensure that the process is still replicatable.</p><ul><li><em>Reboot into a LiveUSB</em> to prevent file loss during the backup process.</li></ul></li></ul><h2 id=before-backup>Before Backup</h2><ul><li><p><em>If you want to backup your files in your dual-boot OS</em> (Windows): you need
to install ntfs-3g which will allow you to mount the Windows partition
without problems.</p><ul><li><code>pacman -S ntfs-3g</code>.</li></ul></li><li><p><code>mkdir /x; mount /dev/sdaX /x</code> (Replace: /X/ = partition, <em>x</em> = folder-name).</p></li><li><p><code>mount /dev/sdaX /mnt</code> (/X/ = root-partition), do not mount <code>/home</code> otherwise
it will backup alongside the <code>/root</code> backup of the partition.</p></li><li><p><code>tar zcvpf /PATH/TO/BACKUP_PARTITION/root.tar.gz -C /mnt .</code></p></li><li><p><em>When the backup has finished without returning errors</em> => reboot and later
check the files in the new archived folder to confirm that the files had
indeed finished the backup process without trouble.</p></li><li><p>Reboot to LiveUSB or just ignore this and finish the rest of this guide.</p></li></ul><h2 id=after-backup>After Backup</h2><ol><li><p>Boot into your LiveUSB.</p></li><li><p>Confirm that you are either using GPT or MBR through <code>gdisk /dev/sda</code>.</p></li><li><p>Type <code>p</code> -> hit enter and you should be greeted with the current partition
scheme.</p></li><li><p>Type <code>d</code> to remove partition and then <code>X</code> (replace /X/ with the number for
your <code>/home</code> partition)</p></li><li><p>Repeat step 3, but replace <em>X</em> with the number for the <code>root</code> partition.
a. If the process was successful, there should be no file loss from your
<code>root</code> partition due to the creation of a merged partition rather than the
deletion of the partition, which would transfer the files to the new
partition instead of removing them.</p></li><li><p><em>During the writing of this guide, <strong>I had used two EXT4 partitions</strong> for both
partitions</em>, therefore you should note that the method is different for other
partition types. (Hexcode number: 8300)</p></li><li><p>Type ~n<code>to create a new partition and later choose the number for your partition with the block size set from the</code>start sector<code>to the</code>end sector<code>. a. Double check your </code>start sector<code>and your</code>end sector`.</p></li><li><p>Type <code>p</code> to check the partition scheme and ensure that the new partition =
<code>/home + /root</code> size and make sure to check the Hexcode number for the
partition is the same as it previously was. (Hexcode number = 8300).</p></li><li><p>If you are satisfied with the new partition, type <code>w</code> to write the new
partition.</p></li><li><p>Expand the filesystem using <code>resize2fs</code>:
a. <code>resize2fs /dev/sdaX</code>, where <em>X</em> = number of the new created partition.
b. If it returns <code>e2fck -f /dev/sdaX``, then execute that command + the </code>resize2fs` command afterwards.</p></li><li><p>Mount the newly expanded partition to <code>/mnt</code>:
a. <code>mount /dev/sdaX /mnt</code>
b. Do: <code>ls /mnt</code> to check if your old <code>/root</code> files are still present.</p></li><li><p><code>mkdir /x; mount /dev/sdaX /x</code> and locate your saved <code>/home.tar.gz</code> file
using <code>cd</code>.</p></li><li><p><code>tar -zxpvf /PATH/TO/home.tar.gz -C /mnt/home</code> to unpack your files to
<code>/home</code> directory.</p></li><li><p>Remove old <code>/home</code> partition from <code>fstab</code> from another window,
<code>CTRL+ALT+F3</code>, through <code>nano /mnt/etc/fstab</code> + remove old lines for <code>/home</code>.</p></li></ol><h1 id=lastly>Lastly</h1><ol><li><p>To ensure that the process is working as expected do <code>ls -l /mnt/home/</code>.
a. It should <strong>not</strong> be <code>0</code> because the old files in <code>/home</code> have
transferred to the new <code>/root</code> partition!</p></li><li><p>Return to the window where you ran the tar command through <code>CTRL+ALT+F3</code>,
when the process has finished run <code>sync</code>.</p></li><li><p>Check your files through <code>ls</code> and if you are satisfied&mldr;. <code>reboot</code>.</p></li></ol><h1 id=good-job>Good Job!</h1><p>Now you have one unified partition rather than two :P</p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2022 Cursed Notebook</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.14.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#current-partition-scheme>Current Partition Scheme</a></li></ol><ol><li><a href=#important>IMPORTANT</a></li><li><a href=#before-backup>Before Backup</a></li><li><a href=#after-backup>After Backup</a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>